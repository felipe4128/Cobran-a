<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Contrato {{ contrato.id }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        label { display: block; margin-top: 10px; }
        input, select, textarea { width: 100%; padding: 5px; margin-top: 5px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        table, th, td { border: 1px solid #ccc; }
        th, td { padding: 8px; text-align: center; }
        button { margin-top: 15px; padding: 8px 12px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Contrato - {{ contrato.cliente }}</h1>

    <form method="POST">
        <label>Cliente:
            <input type="text" name="cliente" value="{{ contrato.cliente }}">
        </label>
        <label>Número:
            <input type="text" name="numero" value="{{ contrato.numero }}">
        </label>
        <label>Tipo de Contrato:
            <input type="text" name="tipo_contrato" value="{{ contrato.tipo_contrato }}">
        </label>
        <label>Garantia:
            <input type="text" name="garantia" value="{{ contrato.garantia }}">
        </label>
        <label>Data do Contrato:
            <input type="date" name="data_contrato" value="{{ contrato.data_contrato.strftime('%Y-%m-%d') if contrato.data_contrato else '' }}">
        </label>
        <label>Valor:
            <input type="number" step="0.01" name="valor" value="{{ contrato.valor }}">
        </label>
        <label>Parcelas:
            <input type="number" name="parcelas" value="{{ contrato.parcelas }}">
        </label>
        <label>Parcelas Restantes:
            <input type="number" name="parcelas_restantes" value="{{ contrato.parcelas_restantes }}">
        </label>
        <label>Vencimento Parcelas:
            <input type="date" name="vencimento_parcelas" value="{{ contrato.vencimento_parcelas.strftime('%Y-%m-%d') if contrato.vencimento_parcelas else '' }}">
        </label>

        <button type="submit">Salvar Alterações</button>
        <a href="/">Cancelar</a>
    </form>

    <h2>Parcelas</h2>
    <table>
        <thead>
            <tr>
                <th>Nº</th>
                <th>Valor</th>
                <th>Vencimento</th>
                <th>Status</th>
                <th>Ação</th>
            </tr>
        </thead>
        <tbody>
            {% for parcela in parcelas %}
            <tr>
                <td>{{ parcela.numero }}</td>
                <td>{{ parcela.valor }}</td>
                <td>{{ parcela.vencimento.strftime('%d/%m/%Y') }}</td>
                <td>{{ 'Quitada' if parcela.quitada else 'Em aberto' }}</td>
                <td>
                    {% if not parcela.quitada %}
                    <form method="POST" action="/parcela/{{ parcela.id }}/quitar">
                        <button type="submit">Quitar</button>
                    </form>
                    {% else %}
                    -
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>